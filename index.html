<!DOCTYPE html>
<html>
<head>
    <title>Chatbot via SSO</title>
    <script>
        // Função para buscar o token
        async function fetchAccessToken() {
            try {
                const response = await fetch('/api/x_your_namespace/get_token'); // Substitua pelo endpoint correto
                const result = await response.json();

                if (result.success) {
                    console.log("Access Token:", result.token);
                    initializeChatbot(result.token);
                } else {
                    alert(result.message || "Access denied: Unable to authenticate via SSO.");
                }
            } catch (error) {
                console.error("Error fetching token:", error);
                alert("An error occurred while authenticating.");
            }
        }

        // Função para inicializar o chatbot
        function initializeChatbot(token) {
            // Exemplo com token no Virtual Agent
            const chatbotIframe = document.getElementById("chatbot");
            chatbotIframe.src = `https://your-instance.service-now.com/api/sn_va_as_service/virtualagent?vafRuntimeMode=true&sysparm_ssotoken=${token}`;
            chatbotIframe.style.display = "block";
        }

        // Chama a função ao carregar a página
        window.onload = fetchAccessToken;
    </script>
</head>
<body>
    <h1>Bem-vindo ao Chatbot</h1>
    <iframe id="chatbot" style="width: 100%; height: 500px; display: none;"></iframe>
</body>
</html>
